<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚«ã‚¹ã‚¿ãƒ ãƒ»ãƒ¬ã‚¸æ‰“ã¡ãƒã‚¹ã‚¿ãƒ¼ Pro</title>
    <style>
        body { font-family: sans-serif; background-color: #fdf6e3; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); width: 100%; max-width: 500px; }
        h1 { text-align: center; color: #555; margin-bottom: 10px; }
        
        /* è¨­å®šã‚¨ãƒªã‚¢ */
        .admin-section { background: #e0f2f1; padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #b2dfdb; }
        .admin-section h2 { font-size: 1em; margin-top: 0; color: #00796b; margin-bottom: 10px; }
        .input-group { display: flex; gap: 5px; margin-bottom: 10px; align-items: center; }
        input { padding: 8px; border: 1px solid #ccc; border-radius: 4px; flex: 1; font-size: 0.9em; }
        .label-text { font-size: 0.85em; color: #00796b; font-weight: bold; min-width: 80px; }
        .add-master-btn { background: #009688; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; }

        /* è¡¨ç¤ºã‚¨ãƒªã‚¢ */
        .display { background: #333; color: #0f0; padding: 15px; border-radius: 5px; text-align: right; font-size: 1.2em; margin-bottom: 10px; border: 4px solid #555; }
        .cart { font-size: 0.9em; color: #666; min-height: 40px; border-bottom: 1px solid #eee; margin-bottom: 10px; padding-bottom: 10px; line-height: 1.4; }
        
        /* å•†å“ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ */
        .item-list { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .item-btn { background-color: #fff; border: 2px solid #ffab91; padding: 10px; border-radius: 8px; cursor: pointer; font-size: 0.9em; transition: 0.1s; }
        .item-btn:active { background-color: #ffccbc; transform: translateY(2px); }

        /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .action-area { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn { padding: 12px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.1s; }
        .btn:active { transform: translateY(2px); filter: brightness(0.9); }
        .sale-btn { background: #fff176; border: 2px solid #fbc02d; grid-column: span 2; font-size: 1.1em; }
        .pay-btn { background: #81c784; color: white; border-bottom: 4px solid #4caf50; }
        .clear-btn { background: #ef9a9a; color: white; border-bottom: 4px solid #e57373; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ›’ ã˜ã¶ã‚“ãƒ¬ã‚¸ Pro</h1>

    <div class="admin-section">
        <h2>ğŸ› ï¸ ãŠåº—ã®ã›ã£ã¦ã„</h2>
        <div class="input-group">
            <span class="label-text">å•†å“è¿½åŠ :</span>
            <input type="text" id="new-item-name" placeholder="å•†å“å">
            <input type="number" id="new-item-price" placeholder="å€¤æ®µ">
            <button class="add-master-btn" onclick="addNewProduct()">è¿½åŠ </button>
        </div>
        <div class="input-group">
            <span class="label-text">ã‚¿ã‚¤ãƒ ã‚»ãƒ¼ãƒ«:</span>
            <input type="number" id="discount-rate-input" value="10" min="0" max="100">
            <span style="font-size: 0.9em; color: #00796b;">% å¼•ãã«ã™ã‚‹</span>
        </div>
    </div>

    <div class="display" id="total-display">åˆè¨ˆ: Â¥0</div>
    <div id="status-badge" style="color: #d32f2f; font-weight: bold; font-size: 0.8em; height: 1.2em;"></div>
    <div class="cart" id="cart-list">ã‚«ãƒ¼ãƒˆã¯ç©ºã§ã™</div>

    <div class="item-list" id="button-container"></div>
    
    <div class="action-area">
        <button class="btn sale-btn" id="sale-button-text" onclick="applyDiscount()">âœ¨ ã‚¿ã‚¤ãƒ ã‚»ãƒ¼ãƒ«å®Ÿè¡Œï¼ âœ¨</button>
        <button class="btn pay-btn" onclick="checkout()">ãŠä¼šè¨ˆ (10%ç¨è¾¼)</button>
        <button class="btn clear-btn" onclick="resetCart()">å…¨éƒ¨æ¶ˆã™</button>
    </div>
</div>

<script>
    let cart = [];
    let isDiscounted = false;
    let activeDiscountRate = 0;

    const defaultProducts = [
        { name: 'ã‚Šã‚“ã”', price: 120 },
        { name: 'ç‰›ä¹³', price: 200 },
        { name: 'ãƒ‘ãƒ³', price: 150 }
    ];

    function renderButtons() {
        const container = document.getElementById('button-container');
        container.innerHTML = '';
        defaultProducts.forEach(product => {
            const btn = document.createElement('button');
            btn.className = 'item-btn';
            btn.innerHTML = `<b>${product.name}</b><br>Â¥${product.price}`;
            btn.onclick = () => addItem(product.name, product.price);
            container.appendChild(btn);
        });
    }

    function addNewProduct() {
        const name = document.getElementById('new-item-name').value;
        const price = parseInt(document.getElementById('new-item-price').value);
        if (name === "" || isNaN(price)) { alert("åå‰ã¨å€¤æ®µã‚’å…¥ã‚Œã¦ã­ï¼"); return; }
        defaultProducts.push({ name: name, price: price });
        renderButtons();
        document.getElementById('new-item-name').value = "";
        document.getElementById('new-item-price').value = "";
    }

    function addItem(name, price) {
        cart.push({ name: name, price: price });
        updateDisplay();
    }

    function updateDisplay() {
        const cartList = document.getElementById('cart-list');
        const totalDisplay = document.getElementById('total-display');
        const statusBadge = document.getElementById('status-badge');
        
        if (cart.length === 0) {
            cartList.innerText = "ã‚«ãƒ¼ãƒˆã¯ç©ºã§ã™";
            totalDisplay.innerText = "åˆè¨ˆ: Â¥0";
            statusBadge.innerText = "";
            isDiscounted = false;
            return;
        }

        let subtotal = cart.reduce((sum, item) => sum + item.price, 0);
        
        if (isDiscounted) {
            // å‰²å¼•è¨ˆç®—: å…ƒã®å€¤æ®µ * (1 - å‰²å¼•ç‡/100)
            subtotal = Math.floor(subtotal * (1 - activeDiscountRate / 100));
            statusBadge.innerText = `ğŸ”¥ ã‚¿ã‚¤ãƒ ã‚»ãƒ¼ãƒ«ä¸­ï¼(${activeDiscountRate}% OFF)`;
        } else {
            statusBadge.innerText = "";
        }

        cartList.innerHTML = "<b>ä¸­èº«:</b> " + cart.map(item => item.name).join('ã€');
        totalDisplay.innerText = `åˆè¨ˆ: Â¥${subtotal}`;
    }

    function applyDiscount() {
        if (cart.length === 0) return;
        // å…¥åŠ›ã•ã‚Œã¦ã„ã‚‹å‰²å¼•ç‡ã‚’å–å¾—
        activeDiscountRate = parseInt(document.getElementById('discount-rate-input').value);
        if (isNaN(activeDiscountRate)) activeDiscountRate = 0;
        
        isDiscounted = true;
        updateDisplay();
    }

    function checkout() {
        if (cart.length === 0) return;
        
        let subtotal = cart.reduce((sum, item) => sum + item.price, 0);
        if (isDiscounted) {
            subtotal = Math.floor(subtotal * (1 - activeDiscountRate / 100));
        }
        
        const tax = Math.floor(subtotal * 0.1);
        const finalTotal = subtotal + tax;

        const payment = prompt(`ã€ãƒ¬ã‚¸æ‰“ã¡ãƒã‚§ãƒƒã‚¯ã€‘\nç¨ã¬ãåˆè¨ˆï¼šÂ¥${subtotal}\næ¶ˆè²»ç¨(10%)ï¼šÂ¥${tax}\nãŠæ”¯æ‰•ã„åˆè¨ˆï¼šÂ¥${finalTotal}\n\nã„ãã‚‰é ã‹ã‚Šã¾ã™ã‹ï¼Ÿ`);
        
        if (payment !== null) {
            const change = payment - finalTotal;
            if (change >= 0) {
                alert(`ãŠè²·ã„ä¸Šã’ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼\nãŠé‡£ã‚Šã¯ Â¥${change} ã§ã™ã€‚ã¾ãŸæ¥ã¦ã­ï¼`);
                resetCart();
            } else {
                alert(`ãŠé‡‘ãŒ Â¥${Math.abs(change)} è¶³ã‚Šãªã„ã‚ˆï¼`);
            }
        }
    }

    function resetCart() {
        cart = [];
        isDiscounted = false;
        updateDisplay();
    }

    renderButtons();
</script>

</body>
</html>